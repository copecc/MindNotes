---
title: 基环树
tags:
  - 基环树
  - Pseudotree
---

# 基环树

对于一个连通图 $G$，如果其点数与边数相等，那我们便称它为一个基环树（$\text{Pseudotree}$）。也就是说，基环树是一个包含恰好一个环的连通图。

??? note "[发现环](https://www.luogu.com.cn/problem/P8655){target='_blank'}"

    给定一个包含 $n$ 个点和 $n$ 条边的无向图，图中恰有一个环。请你找出环上的所有点。

    ??? hint 

        对于无向图，可以将每条边视为双向边。统计每个点的度数，环上的点度数至少为 $2$，而树枝上的点度数为 $1$。通过拓扑排序可以将所有树枝上的点剔除，剩下的即为环上的点。

    ```cpp
    --8<-- "code/Tree/PseudoTree/P8655.cpp"
    ```


## 内向基环树

基环内向树（$\text{Inward Pseudotree}$）：有向弱连通图每个点的出度都为 $1$。

常常将内向基环树与拓扑排序结合使用，以求出每个点距离环的距离。对于环上的点，距离定义为环的大小；对于树枝上的点，距离定义为其到环上最近点的距离。

环上的点与树枝上的点可以通过统计入度来区分。环上的点入度至少为 $1$，而树枝上的点入度为 $0$。通过拓扑排序可以将所有树枝上的点剔除，剩下的即为环上的点。随后可以通过 BFS 从环上点开始，向树枝上扩展，计算每个点距离环的距离。

???+ note "[参加会议的最多员工数](https://leetcode.cn/problems/maximum-employees-to-be-invited-to-a-meeting/description/){target='_blank'}"

    一个公司准备组织一场会议，邀请名单上有 $n$ 位员工。公司准备了一张圆形的桌子，可以坐下任意数目的员工。

    员工编号为 $0$ 到 $n - 1$ 。每位员工都有一位喜欢的员工，每位员工当且仅当他被安排在喜欢员工的旁边，他才会参加会议。每位员工喜欢的员工不会是他自己。

    给你一个下标从 $0$ 开始的整数数组 $favorite$，其中 $favorite[i]$ 表示第 $i$ 位员工喜欢的员工。请你返回参加会议的最多员工数目。

    ```cpp
    --8<-- "code/Tree/PseudoTree/maximum-employees-to-be-invited-to-a-meeting.cpp"
    ```
    {.annotate}

    1. 对于其他更复杂的性质，可以在拓扑排序过程中构建反图，反图中只包含树枝上的点，从而在后续处理中可以区分环上点与树枝上点。

## 外向基环树

基环外向树（$\text{Outward Pseudotree}$）：有向弱连通图每个点的入度都为 $1$。

处理方式与内向基环树类似，只需将入度改为出度即可。
