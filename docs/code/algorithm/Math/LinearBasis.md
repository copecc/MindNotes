---
title: 线性基
tags:
  - 线性基
  - Linear Basis
---

# 线性基

线性基（$\text{Linear Basis}$）是一种用于处理向量空间中线性无关向量集合的数据结构。它可以用于解决一系列与线性代数相关的问题，如求解线性方程组、计算向量的秩、寻找最大异或子集等。  
线性基是一个向量组，可以表示该向量组中任意向量的线性组合。线性基的主要特点是其向量之间线性无关，即没有一个向量可以表示为其他向量的线性组合（线性无关性）。线性基的大小等于该向量组的秩。  
线性基的时间复杂度通常为 $O(n \cdot m)$，其中 $n$ 是向量的维度，$m$ 是插入的向量数量。  

## 普通消元

普通消元法通过逐步消去向量中的最高位来构建线性基（贪心构造）。  
该方法可以求出线性基的最大异或和、最小异或和、秩、能表示的数的个数、是否能表示某个数等信息。  

??? note "[【模板】线性基](https://www.luogu.com.cn/problem/P3812){target=_blank}"

    给定一个整数数组 $a$，构建其线性基。 求线性基的最大异或和。  

    ```cpp
    --8<-- "code/Math/LinearBasis/P3812.cpp"
    ```


## 高斯消元

高斯消元法通过将向量组表示为矩阵，并对矩阵进行行变换来构建线性基。  
该方法可以求出线性基的最大异或和、最小异或和、第 $k$ 大异或和（普通消元法不能求出）、秩、能表示的数的个数、是否能表示某个数等信息。  

??? note "[k 大异或和](https://loj.ac/p/114){target=_blank}"

    给定一个整数数组 $a$，构建其线性基。 对于 $m$ 个查询，每个查询给出一个整数 $k$，求第 $k$ 大异或和。如果 $k$ 超出范围，输出 $-1$。  

    ```cpp
    --8<-- "code/Math/LinearBasis/LOJ114.cpp"
    ```

## 向量线性基

向量线性基是线性基的一种扩展，适用于处理高维向量空间中的线性无关向量集合。  

??? note "[装备购买](https://www.luogu.com.cn/problem/P3265){target=_blank}"

    有 $n$ 件装备，每件装备有 $m$ 个属性，装备 $i$ 的属性为 $a_{i1}, a_{i2}, \ldots, a_{im}$，且有一个购买费用 $c_i$。 现在需要从中选择一些装备，使得这些装备的属性向量线性无关，且购买费用之和最小。 输出最多能选择多少件装备，以及对应的最小费用。  

    ```cpp
    --8<-- "code/Math/LinearBasis/P3265.cpp"
    ```

## 树上线性基

树上线性基是线性基的一种应用，适用于处理树结构中的路径查询问题，可以结合 $LCA$ 将路径查询转化为节点的异或和。  
每个节点维护从根节点到该节点的线性基。具体来说，孩子节点首先继承父节点的线性基，然后将当前节点的值插入到线性基中。  

- 如果当前节点的值可以由线性基表示，则保留深度较大的值作为线性基的一部分
- 然后将淘汰的值重新插入到线性基中（根据深度判断是执行异或还是继续淘汰）
- 直到淘汰的值无法再插入为止